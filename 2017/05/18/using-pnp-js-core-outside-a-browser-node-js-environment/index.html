
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Using PnP JS Core outside a browser (Node.js environment)</title>
    <meta name="description" content="">

    <meta name="google-site-verification" content="kj4x9HBApwneuGIIlFZj11VGEQnPG5Mp21U2n_mSCcU">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="/assets/images/favicon.ico?v=6b16a2aa91">

    <link rel="stylesheet" type="text/css" href="/assets/css/arvo-bundle.css?v=6b16a2aa91">
    <link rel="stylesheet" type="text/css" href="/assets/css/prism.css?v=6b16a2aa91">
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css?v=6b16a2aa91">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400">

    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="ARVO Systems Blog">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Using PnP JS Core outside a browser (Node.js environment)">
    <meta property="og:description" content="Expanding scopes of usage of favorite tools I wrote about PnP JS Core 9 month ago. In those post, I shared my experience of first steps with the library and decision to give it a shot on the projects. And what can I say after these months? Now it's one">
    <meta property="og:url" content="/2017/05/18/using-pnp-js-core-outside-a-browser-node-js-environment/">
    <meta property="og:image" content="/content/images/2017/05/sp-pnp-node-2.png">
    <meta property="article:published_time" content="2017-05-18T07:01:43.000Z">
    <meta property="article:modified_time" content="2017-05-18T07:05:41.000Z">
    <meta property="article:tag" content="SharePoint">
    <meta property="article:tag" content="Node.js">
    <meta property="article:tag" content="PnP">
    <meta property="article:tag" content="REST">
    <meta property="article:tag" content="PnP JS Core">
    
    <meta property="article:author" content="https://www.facebook.com/andrew.koltyakov">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Using PnP JS Core outside a browser (Node.js environment)">
    <meta name="twitter:description" content="Expanding scopes of usage of favorite tools I wrote about PnP JS Core 9 month ago. In those post, I shared my experience of first steps with the library and decision to give it a shot on the projects. And what can I say after these months? Now it's one">
    <meta name="twitter:url" content="/2017/05/18/using-pnp-js-core-outside-a-browser-node-js-environment/">
    <meta name="twitter:image" content="/content/images/2017/05/sp-pnp-node-2.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Andrew Koltyakov">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="SharePoint, Node.js, PnP, REST, PnP JS Core">
    <meta name="twitter:creator" content="@AndrewKoltyakov">
    <meta property="og:image:width" content="1280">
    <meta property="og:image:height" content="400">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "ARVO Systems Blog",
        "logo": {
            "@type": "ImageObject",
            "url": "/content/images/2016/09/arvo_logo_105px.png",
            "width": 105,
            "height": 42
        }
    },
    "author": {
        "@type": "Person",
        "name": "Andrew Koltyakov",
        "image": {
            "@type": "ImageObject",
            "url": "/content/images/2016/09/andrew.koltyakov.jpg",
            "width": 460,
            "height": 460
        },
        "url": "/author/andrew/",
        "sameAs": [
            "http://koltyakov.ru",
            "https://www.facebook.com/andrew.koltyakov",
            "https://twitter.com/AndrewKoltyakov"
        ],
        "description": "SharePoint Front-End Developer"
    },
    "headline": "Using PnP JS Core outside a browser (Node.js environment)",
    "url": "/2017/05/18/using-pnp-js-core-outside-a-browser-node-js-environment/",
    "datePublished": "2017-05-18T07:01:43.000Z",
    "dateModified": "2017-05-18T07:05:41.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "/content/images/2017/05/sp-pnp-node-2.png",
        "width": 1280,
        "height": 400
    },
    "keywords": "SharePoint, Node.js, PnP, REST, PnP JS Core",
    "description": "Expanding scopes of usage of favorite tools I wrote about PnP JS Core 9 month ago. In those post, I shared my experience of first steps with the library and decision to give it a shot on the projects. And what can I say after these months? Now it&#x27;s one",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://external.arvosys.com:2368"
    }
}
    </script>

    <meta name="generator" content="Ghost 0.10">
    <link rel="alternate" type="application/rss+xml" title="ARVO Systems Blog" href="../../../../rss/index.html">
</head>
<body class="post-template tag-sharepoint tag-node-js tag-pnp tag-rest tag-pnp-js-core nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="index.html#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-blog-home" role="presentation"><a href="../../../../">Blog Home</a></li>
            <li class="nav-search" role="presentation"><a href="http://www.arvosys.com/search/">Search</a></li>
            <li class="nav-arvo-systems" role="presentation"><a href="http://www.arvosys.com/">ARVO Systems</a></li>
            <li class="nav--services" role="presentation"><a href="http://www.arvosys.com/services/">... Services</a></li>
            <li class="nav--platforms" role="presentation"><a href="http://www.arvosys.com/platforms/">... Platforms</a></li>
            <li class="nav--contacts" role="presentation"><a href="http://www.arvosys.com/about/contacts/">... Contacts</a></li>
    </ul>
        <a class="subscribe-button icon-feed" href="../../../../rss/index.rss">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">
        <div id="content-wrapper" class="page-content">

            


<header class="main-header post-head " style="background-image: url(../../../../content/images/2017/05/sp-pnp-node-2.png)">
    <nav class="main-nav overlay clearfix">
        <a class="blog-logo" href="../../../../"><img src="../../../../content/images/2016/09/arvo_logo_105px.png" alt="ARVO Systems Blog"></a>
            <a class="menu-button icon-menu" href="index.html#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-sharepoint tag-node-js tag-pnp tag-rest tag-pnp-js-core">

        <header class="post-header">
            <h1 class="post-title">Using PnP JS Core outside a browser (Node.js environment)</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2017-05-18">18 May 2017</time>  on <a href="../../../../tag/sharepoint/">SharePoint</a>, <a href="../../../../tag/node-js/">Node.js</a>, <a href="../../../../tag/pnp/">PnP</a>, <a href="../../../../tag/rest/">REST</a>, <a href="../../../../tag/pnp-js-core/">PnP JS Core</a>
            </section>
        </header>

        <section class="post-content">
            <blockquote>
  <p>Expanding scopes of usage of favorite tools</p>
</blockquote>

<p>I <a href="../../../../2016/09/09/sharepoint-pnp-javascript-core-components-deserve-more-attention/">wrote</a> about <a href="https://github.com/SharePoint/PnP-JS-Core">PnP JS Core</a> 9 month ago. In those post, I shared my experience of first steps with the library and decision to give it a shot on the projects.</p>

<p>And what can I say after these months? Now it's one of the must have dependencies on any new front-end project I scaffold for SharePoint. I almost have forgotten when I needed to grab old fellow JSOM (sp.js) for the reason of communication with SharePoint API within a UI application. It works almost for anything available in REST API. There are some gaps and scenarios in the API when REST have no existing methods implementation (<a href="https://github.com/SharePoint/PnP-JS-Core/issues/415">Manage Metadata</a>, some areas of <a href="../../../02/16/working-with-sharepoint-ups-in-node-js/">User Profiles Services</a>, <a href="https://github.com/SharePoint/PnP-JS-Core/issues/455">indexed properties</a>, etc.) though it's not something which you need very often in UI application. For the methods, what are there in the REST API, PnP JS Core is an awesome shiny tool.</p>

<p>With time, I faced a couple of project needs where I got to fetch some metadata and data within Node.js using REST where hands themselves started writing in PnP JS Core. Yes, I know that it's not a big deal to prepare REST endpoint URIs and some JSON packages for such tasks. But it's a question of reusability and convenience writing code using your favorite API wrapper.</p>

<p>Luckily, I was not along with such an idea and some folks already <a href="https://blogs.msdn.microsoft.com/patrickrodgers/2016/10/17/using-pnp-js-core-and-node-sp-auth/">experimented</a> with it and even created <a href="https://github.com/s-KaiNet/node-pnpjs-sample">examples</a> on GitHub. It was a matter of minutes to grab those concepts and successfully run PnP JS Core in Node.js on the server side.</p>

<p>The suggested method with "patching" global variables, request headers and fetch client worked perfectly on a production for a couple of different things, one of which is extracting metadata for almost 20 hundred different SharePoint artifact elements.</p>

<p>Month later, I faced a need to reuse the technique and not just once but for a number of times.</p>

<p>Well, it was a perfect time to wrap fetch client patching code into some reusable way and avoid copy &amp; pasting between the projects. Said and done. I created a library named <a href="https://github.com/koltyakov/sp-pnp-node">sp-pnp-node</a>, which abstracts away any http request patching experience and allows minify extra code.</p>

<p>One can install dependency with NPM or Yarn:</p>

<p><strong>NPM</strong></p>

<pre><code class="language-bash">npm install sp-pnp-node --save  
</code></pre>

<p><strong>Yarn</strong></p>

<pre><code class="language-bash">yarn add sp-pnp-node --save  
</code></pre>

<p>Then start using it in server side JavaScript or TypeScript.</p>

<p><strong>Usage in TypeScript</strong></p>

<pre><code class="language-javascript">import { PnPNode } from 'sp-pnp-node';  
import { Web } from 'sp-pnp-js';

(new PnPNode()).init().then((settings) =&gt; {

    // Here goes PnP JS Core code
    let web: Web = new Web(settings.siteUrl);
    // ... do whatever you like with PnP JS Core

});
</code></pre>

<p><strong>Usage in ES6</strong></p>

<pre><code class="language-javascript">const PnPNode = require('sp-pnp-node').PnPNode;  
const pnp = require('sp-pnp-js');

(new PnPNode()).init().then((settings) =&gt; {

    // Here goes PnP JS Core code
    let web = new pnp.Web(settings.siteUrl);
    // ... do whatever you like with PnP JS Core

});
</code></pre>

<p>Three additional lines of code and you are in ready PnP JS Core'ing.</p>

<p>It's possible to define some extra settings, yet my number one idea was to make it as simple to use as possible. So, a new object instance of <code>PnPNode</code> can be created with a default settings by providing no configuration parameters in the code at all. What does that mean? How does the lib understand which environment and credentials to use? It will ask for authentication options in a wizard like way and will dump the inputs to a config file, it will even hash your password so it will not be there as a plain text unless you need it to.</p>

<p>Those who familiar with some other projects of myself knows I use <code>node-sp-auth</code> heavily for authentication in SharePoint when dealing with Node.js. To share similar user experience with auth configuration <a href="https://github.com/koltyakov/node-sp-auth-config">node-sp-auth-config</a> was integrated to this lib too. That is <code>node-sp-auth-config</code> in charge for asking and saving these settings.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Once again, I recommend PnP JS Core for the stuff it was designed for. Nine months of constant usage of the library is a strong argument.</p>

<p>Browser is not the only home for PnP JS Core and with tools like <a href="https://github.com/koltyakov/sp-pnp-node">sp-pnp-node</a> it can be smoothly executed in Node.js (console apps, timer jobs, microservices, electron apps, all of these are benevolent to it).</p>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="../../../../author/andrew/" style="background-image: url(../../../../content/images/2016/09/andrew.koltyakov.jpg)"><span class="hidden">Andrew Koltyakov's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="../../../../author/andrew/">Andrew Koltyakov</a></h4>

                    <p>SharePoint Front-End Developer</p>
                <div class="author-meta">
                    
                    <span class="author-link icon-link"><a href="http://koltyakov.ru">http://koltyakov.ru</a></span>
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Using%20PnP%20JS%20Core%20outside%20a%20browser%20(Node.js%20environment)&amp;url=/2017/05/18/using-pnp-js-core-outside-a-browser-node-js-environment/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=/2017/05/18/using-pnp-js-core-outside-a-browser-node-js-environment/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=/2017/05/18/using-pnp-js-core-outside-a-browser-node-js-environment/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>


        </footer>

        <!-- Comments -->
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = "arvo-systems-blog-com";
            (function() {
                var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
                dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
                (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
            })();
        </script>
        <!-- Comments -->

    </article>

</main>

<aside class="read-next">
    <a class="read-next-story " style="background-image: url(../../../../content/images/2017/06/JsomNodeWide.png)" href="../../../06/05/using-jsom-csom-sharepoint-client-side-object-model-in-node-js/">
        <section class="post">
            <h2>Using JSOM (CSOM, SharePoint Client Side Object Model) in Node.js</h2>
            <p>Intro It's not a secret that it's theoretically feasible to execute SharePoint Client Side Object Model in Node.js.…</p>
        </section>
    </a>
    <a class="read-next-story prev " style="background-image: url(../../../../content/images/2017/02/UPS-node.png)" href="../../../02/16/working-with-sharepoint-ups-in-node-js/">
        <section class="post">
            <h2>Working with SharePoint UPS in Node.js</h2>
            <p>This article is a logical continuation of my previous post where I described Node.js way of dealing with…</p>
        </section>
    </a>
</aside>



        </div>
    </div>

    <div id="footer" class="bg-dark fg-white">
        <div class="container">
            <div class="brands">
                <div class="padding10 footer-element">
                <img class="sh" src="/assets/images/o365_nm_ft_i.png?v=6b16a2aa91" style="display: none;">
                <img class="fl" src="/assets/images/o365_nm_ft.png?v=6b16a2aa91">
                </div>
                <div class="padding10 footer-element">
                <img class="sh" src="/assets/images/sp_nm_ft_i.png?v=6b16a2aa91" style="display: none;">
                <img class="fl" src="/assets/images/sp_nm_ft.png?v=6b16a2aa91">
                </div>
                <div class="padding10 footer-element">
                <img class="sh" src="/assets/images/msp_nm_ft_i.png?v=6b16a2aa91" style="display: none;">
                <img class="fl" src="/assets/images/msp_nm_ft.png?v=6b16a2aa91">
                </div>		
            </div>
            <div class="copyright">
                <div class="padding10 footer-element">
                <img src="/assets/images/arvo_nm_ft.png?v=6b16a2aa91">
                </div>    
                <div class="padding10 footer-element copy-text">© 2016<br>
                <small>All rights reserved</small>
                </div> 
            </div>
        </div>
    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js?v=6b16a2aa91"></script>
    <script type="text/javascript" src="/assets/js/index.js?v=6b16a2aa91"></script>
    <script type="text/javascript" src="/assets/js/prism.js?v=6b16a2aa91"></script>

    <!-- Piwik -->
    <script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(["setDomains", ["*.arvosys.com","*.blog.arvosys.com","*.www.arvosys.com","*.blog.arvosys.com"]]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
        var u="//piwik.spflow.com/";
        _paq.push(['setTrackerUrl', u+'piwik.php']);
        _paq.push(['setSiteId', '9']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
    })();
    </script>
    <noscript><p><img src="http://piwik.spflow.com/piwik.php?idsite=9" style="border:0;" alt=""></p></noscript>
    <!-- End Piwik Code -->

</body>
