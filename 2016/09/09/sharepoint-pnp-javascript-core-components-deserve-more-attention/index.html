
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>SharePoint PnP JavaScript Core Components – deserve more attention</title>
    <meta name="description" content="">

    <meta name="google-site-verification" content="kj4x9HBApwneuGIIlFZj11VGEQnPG5Mp21U2n_mSCcU">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="/assets/images/favicon.ico?v=f32f57e115">

    <link rel="stylesheet" type="text/css" href="/assets/css/arvo-bundle.css?v=f32f57e115">
    <link rel="stylesheet" type="text/css" href="/assets/css/prism.css?v=f32f57e115">
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css?v=f32f57e115">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400">

    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="ARVO Systems Blog">
    <meta property="og:type" content="article">
    <meta property="og:title" content="SharePoint PnP JavaScript Core Components – deserve more attention">
    <meta property="og:description" content="I've been eschewed PnP-JS-Core for a long time and preferred to use JSOM or plain REST calls with the use of jQuery.ajax or SP.RequestExecutor. &quot;Why do I need any wrappers or helpers for the API stuff which can be an additional point of failure?&quot;, I asked myself a">
    <meta property="og:url" content="/2016/09/09/sharepoint-pnp-javascript-core-components-deserve-more-attention/">
    <meta property="og:image" content="/content/images/2016/09/PnP-JS-Core_banner-2.png">
    <meta property="article:published_time" content="2016-09-09T12:04:00.000Z">
    <meta property="article:modified_time" content="2016-09-12T20:52:08.000Z">
    <meta property="article:tag" content="SharePoint">
    <meta property="article:tag" content="Toolchain">
    <meta property="article:tag" content="REST">
    <meta property="article:tag" content="API">
    <meta property="article:tag" content="sp-rest-proxy">
    <meta property="article:tag" content="PnP">
    
    <meta property="article:author" content="https://www.facebook.com/andrew.koltyakov">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SharePoint PnP JavaScript Core Components – deserve more attention">
    <meta name="twitter:description" content="I've been eschewed PnP-JS-Core for a long time and preferred to use JSOM or plain REST calls with the use of jQuery.ajax or SP.RequestExecutor. &quot;Why do I need any wrappers or helpers for the API stuff which can be an additional point of failure?&quot;, I asked myself a">
    <meta name="twitter:url" content="/2016/09/09/sharepoint-pnp-javascript-core-components-deserve-more-attention/">
    <meta name="twitter:image" content="/content/images/2016/09/PnP-JS-Core_banner-2.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Andrew Koltyakov">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="SharePoint, Toolchain, REST, API, sp-rest-proxy, PnP">
    <meta name="twitter:creator" content="@AndrewKoltyakov">
    <meta property="og:image:width" content="1600">
    <meta property="og:image:height" content="468">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "ARVO Systems Blog",
        "logo": {
            "@type": "ImageObject",
            "url": "/content/images/2016/09/arvo_logo_105px.png",
            "width": 105,
            "height": 42
        }
    },
    "author": {
        "@type": "Person",
        "name": "Andrew Koltyakov",
        "image": {
            "@type": "ImageObject",
            "url": "/content/images/2016/09/andrew.koltyakov.jpg",
            "width": 460,
            "height": 460
        },
        "url": "/author/andrew/",
        "sameAs": [
            "http://koltyakov.ru",
            "https://www.facebook.com/andrew.koltyakov",
            "https://twitter.com/AndrewKoltyakov"
        ],
        "description": "SharePoint Front-End Developer"
    },
    "headline": "SharePoint PnP JavaScript Core Components – deserve more attention",
    "url": "/2016/09/09/sharepoint-pnp-javascript-core-components-deserve-more-attention/",
    "datePublished": "2016-09-09T12:04:00.000Z",
    "dateModified": "2016-09-12T20:52:08.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "/content/images/2016/09/PnP-JS-Core_banner-2.png",
        "width": 1600,
        "height": 468
    },
    "keywords": "SharePoint, Toolchain, REST, API, sp-rest-proxy, PnP",
    "description": "I&#x27;ve been eschewed PnP-JS-Core for a long time and preferred to use JSOM or plain REST calls with the use of jQuery.ajax or SP.RequestExecutor. &quot;Why do I need any wrappers or helpers for the API stuff which can be an additional point of failure?&quot;, I asked myself a",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://external.arvosys.com:2368"
    }
}
    </script>

    <meta name="generator" content="Ghost 0.10">
    <link rel="alternate" type="application/rss+xml" title="ARVO Systems Blog" href="../../../../rss/index.html">
</head>
<body class="post-template tag-sharepoint tag-toolchain tag-rest tag-api tag-sp-rest-proxy tag-pnp nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="index.html#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-blog-home" role="presentation"><a href="../../../../">Blog Home</a></li>
            <li class="nav-search" role="presentation"><a href="http://www.arvosys.com/search/">Search</a></li>
            <li class="nav-arvo-systems" role="presentation"><a href="http://www.arvosys.com/">ARVO Systems</a></li>
            <li class="nav--services" role="presentation"><a href="http://www.arvosys.com/services/">... Services</a></li>
            <li class="nav--platforms" role="presentation"><a href="http://www.arvosys.com/platforms/">... Platforms</a></li>
            <li class="nav--contacts" role="presentation"><a href="http://www.arvosys.com/about/contacts/">... Contacts</a></li>
    </ul>
        <a class="subscribe-button icon-feed" href="../../../../rss/index.rss">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">
        <div id="content-wrapper" class="page-content">

            


<header class="main-header post-head " style="background-image: url(../../../../content/images/2016/09/PnP-JS-Core_banner-2.png)">
    <nav class="main-nav overlay clearfix">
        <a class="blog-logo" href="../../../../"><img src="../../../../content/images/2016/09/arvo_logo_105px.png" alt="ARVO Systems Blog"></a>
            <a class="menu-button icon-menu" href="index.html#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-sharepoint tag-toolchain tag-rest tag-api tag-sp-rest-proxy tag-pnp">

        <header class="post-header">
            <h1 class="post-title">SharePoint PnP JavaScript Core Components – deserve more attention</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2016-09-09">09 September 2016</time>  on <a href="../../../../tag/sharepoint/">SharePoint</a>, <a href="../../../../tag/toolchain/">Toolchain</a>, <a href="../../../../tag/rest/">REST</a>, <a href="../../../../tag/api/">API</a>, <a href="../../../../tag/sp-rest-proxy/">sp-rest-proxy</a>, <a href="../../../../tag/pnp/">PnP</a>
            </section>
        </header>

        <section class="post-content">
            <p>I've been eschewed <a href="http://github.com/OfficeDev/PnP-JS-Core">PnP-JS-Core</a> for a long time and preferred to use JSOM or plain REST calls with the use of jQuery.ajax or SP.RequestExecutor. "Why do I need any wrappers or helpers for the API stuff which can be an additional point of failure?", I asked myself a couple of times putting PnP-JS-Core aside from learning.</p>

<p>But there was an opportunity this week to dive into the library and estimate expediency of its usage on a next project. The first fresh glance at it created a new and rather a positive attitude. First of all, it is made with the toolchain I love, and there are so many familiar faces in its contributors group, I didn’t even know to be related to the project. That was a good sign so I started.</p>

<h2 id="whatisit">What is it</h2>

<p>PnP-JS-Core is a part of Office 365 Developer Patterns and Components for JavaScript’ing in SharePoint.</p>

<p>It is a wrapper over RESTful API and a bit more. PnP JS Core provides a fluent JS API simplifying REST calls to SharePoint API.</p>

<h2 id="stackproject">Stack &amp; Project</h2>

<p>Yes, it’s made with the use of all of that shiny technologies we use on the most modern web projects: JavaScript (TypeScript), Gulp, NPM, Typings, Git, Linting, Serve and cool automation. It’s easy to understand the project structure, logic and contribute.</p>

<p>It is not necessary to investigate the source, but a lot of questions can be solved by checking the code and <a href="http://github.com/OfficeDev/PnP/tree/dev/Samples/SharePoint.pnp-js-core">samples</a>. In the end, PnP-JS-Core is not something complex to learn at all.</p>

<h2 id="usage">Usage</h2>

<p>PnP-JS-Core can be <a href="http://github.com/OfficeDev/PnP-JS-Core/wiki/Install-and-Use">installed</a> with the use of NPM or Bower. The library can be used in TypeScript project or referenced as any other JS library and consumed on a page or browser console.</p>

<p>PnP-JS-Core uses fetch protocol and ES6 promises, that’s why to make it work in IE, polyfills got to be loaded first. It is important to note, otherwise, if this part in documentation was skipped, one would be wondering “What the heck, it doesn’t work in IE? What is that error message in the console, saying "'Headers' is undefined?"”. But keep calm, PnP works perfectly in IE and Edge with es-promise and fetch polyfills.</p>

<h2 id="syntax">Syntax</h2>

<p>PnP-JS-Core has a base object <code>pnp</code> in case of default TypeScript import and <code>$pnp</code> if there is a pnp.js reference on a page and you are writing plain JS in a console or Chrome snippets.</p>

<p>REST calls, with the use of the PnP, can be constructed via fluent API chains with a promise initiator at the end of the statement.</p>

<p>For example, let’s take some basic REST endpoint: <code>/_api/web/lists/getByTitle('CustomList')/items</code> call and reproduce it with the use of pnp:</p>

<pre><code class="language-javascript">$pnp.sp.web 
  .lists.getByTitle('ListTitle').items 
  .get() 
  .then(function(items) { 
    // all items are in the `items` array 
  });
</code></pre>

<p>$pnp.sp.web.lists.getByTitle('Custom01').items – is a constructor which builds endpoints URI.</p>

<p>IntelliSense helps during the process, so you can be even not aware of REST reference or at least have a bad memory and not necessarily remember the endpoints.</p>

<p>Yet, I highly recommend to have a strong understanding of <a href="http://msdn.microsoft.com/en-us/library/office/jj860569.aspx">REST API reference</a> and plan to receive all the fruits that PnP provide only after or use both during the learning curve of course.</p>

<p>When a fluent call is described, <code>get</code> method should be placed to initiate a query to a server. <code>Get</code> method and some others return a promise, that should be chained with <code>then</code> and <code>catch</code> to treat the results.  </p>

<p>Fluent API is really a piece of gold, all that <code>$select</code>, <code>$filter</code>, <code>$extend</code>, <code>$top</code>, etc. parameters are there as helper methods as well. The same is relevant for REST API properties and methods. But not everything is implemented in the current version. So it’s good to compare REST reference and PnP features if you feel like something is missing.</p>

<p>For example, I’ve found myself unable to get a list by its URL, which I accept as the only reasonable way to communicate with lists and libraries in the code (as display title can be changed anytime in the UI and GUIDs-based code is complex to maintain and is not reasonable too, as IDs will be different from deploy to deploy for the same business objects). But less than in a half an hour I managed to fork and implement <code>pnp.sp.web.getList</code> method representation for <code>/_api/web/getlist(‘/sites/site/web/list/name’)</code> and create a pull request for this.</p>

<p>That’s the power of open source.</p>

<h2 id="batches">Batches</h2>

<p>The well-known fact that REST API is very <code>chatty</code> (over the network) one. Sometimes JSOM’s pros argument over REST says that by queueing some OM queries definitions into one physical executeQueryAsync call you can make an application faster. That is definitely true. But did you know that REST also has such tricks in O365 and SharePoint 2016. That is /_api/$batch endpoint.</p>

<p>PnP provides a great simplification for batch REST queries. Any query can be placed in batch call and retrieved inside one single batch execute.</p>

<pre><code class="language-javascript">var batchResults = [];  
var batch = new $pnp.sp.createBatch();  
$pnp.sp.web.getList('/sites/dev01/lists/custom01').items.inBatch(batch).get().then(function(d) {
  batchResults.push({ 
    custom01: d 
  });
});
$pnp.sp.web.getList('/sites/dev01/lists/custom02').items.inBatch(batch).get().then(function(d) {
  batchResults.push({ 
    custom02: d 
  });
});
for (var i = 0, len = 10; i &lt; len; i += 1) {  
  $pnp.sp.web.getList('/sites/dev01/lists/custom03').inBatch(batch).items.add({ 
    Title: 'Item ' + i 
  });
}
batch.execute().then(function() {  
  console.log("All is done!", batchResults);
});
</code></pre>

<p>I was really surprised when discovered such a powerful and simple capability.</p>

<p>Unfortunately, REST batches aren’t supported in On-Prem versions before 2016 version.</p>

<h2 id="conclusion">Conclusion</h2>

<p>There was so much hype around PnP during last few years, but most people (developers or course), with whom I discussed PnP in general, never dived inside it at all, at the same time, were constantly mentioning it as a buzzword on different SP events.</p>

<p>At last, I’ve touched some part of the PnP projects from the JS world side personally and can say it louder that it is a very interesting library, it’s worth learning and I will definitely include it in the next UI project.</p>

<h3 id="upd">UPD:</h3>

<p>I've also tried PnP-JS-Core with <a href="http://github.com/koltyakov/sp-rest-proxy">sp-rest-proxy</a> and it works! :)</p>

<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAj0AAAAJGVhN2VkMDlmLWY0NDItNDVjYS05MTk5LWE1NjFiZWRiOWZhNg.png" alt=""></p>

<p>* This gonna work for GET calls only for now, due to the way sp-rest-proxy and pnp deal with Request Digest on a page.</p>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="../../../../author/andrew/" style="background-image: url(../../../../content/images/2016/09/andrew.koltyakov.jpg)"><span class="hidden">Andrew Koltyakov's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="../../../../author/andrew/">Andrew Koltyakov</a></h4>

                    <p>SharePoint Front-End Developer</p>
                <div class="author-meta">
                    
                    <span class="author-link icon-link"><a href="http://koltyakov.ru">http://koltyakov.ru</a></span>
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=SharePoint%20PnP%20JavaScript%20Core%20Components%20%E2%80%93%20deserve%20more%20attention&amp;url=/2016/09/09/sharepoint-pnp-javascript-core-components-deserve-more-attention/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=/2016/09/09/sharepoint-pnp-javascript-core-components-deserve-more-attention/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=/2016/09/09/sharepoint-pnp-javascript-core-components-deserve-more-attention/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>


        </footer>

        <!-- Comments -->
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = "arvo-systems-blog-com";
            (function() {
                var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
                dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
                (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
            })();
        </script>
        <!-- Comments -->

    </article>

</main>

<aside class="read-next">
    <a class="read-next-story " style="background-image: url(../../../../content/images/2016/11/SharePointLiveReload.png)" href="../../../11/05/sharepoint-client-side-development-with-live-reload/">
        <section class="post">
            <h2>SharePoint client side development with Live Reload</h2>
            <p>We're getting used to modern SharePoint (client side) development day by day. It transforms into some sort of a…</p>
        </section>
    </a>
    <a class="read-next-story prev " style="background-image: url(../../../../content/images/2016/09/RestProxyExample-1.png)" href="../../03/sharepoint-rest-api-proxy-for-local-serve-in-node-js/">
        <section class="post">
            <h2>SharePoint REST API proxy for local serve in Node.js</h2>
            <p>On the recent webcast dedicated to SharePoint Framework hosted by Rencore (SPFx Deep Dive Webinar on Wednesday, 31th of…</p>
        </section>
    </a>
</aside>



        </div>
    </div>

    <div id="footer" class="bg-dark fg-white">
        <div class="container">
            <div class="brands">
                <div class="padding10 footer-element">
                <img class="sh" src="/assets/images/o365_nm_ft_i.png?v=f32f57e115" style="display: none;">
                <img class="fl" src="/assets/images/o365_nm_ft.png?v=f32f57e115">
                </div>
                <div class="padding10 footer-element">
                <img class="sh" src="/assets/images/sp_nm_ft_i.png?v=f32f57e115" style="display: none;">
                <img class="fl" src="/assets/images/sp_nm_ft.png?v=f32f57e115">
                </div>
                <div class="padding10 footer-element">
                <img class="sh" src="/assets/images/msp_nm_ft_i.png?v=f32f57e115" style="display: none;">
                <img class="fl" src="/assets/images/msp_nm_ft.png?v=f32f57e115">
                </div>		
            </div>
            <div class="copyright">
                <div class="padding10 footer-element">
                <img src="/assets/images/arvo_nm_ft.png?v=f32f57e115">
                </div>    
                <div class="padding10 footer-element copy-text">© 2016<br>
                <small>All rights reserved</small>
                </div> 
            </div>
        </div>
    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js?v=f32f57e115"></script>
    <script type="text/javascript" src="/assets/js/index.js?v=f32f57e115"></script>
    <script type="text/javascript" src="/assets/js/prism.js?v=f32f57e115"></script>

    <!-- Piwik -->
    <script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(["setDomains", ["*.arvosys.com","*.blog.arvosys.com","*.www.arvosys.com","*.blog.arvosys.com"]]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
        var u="//piwik.spflow.com/";
        _paq.push(['setTrackerUrl', u+'piwik.php']);
        _paq.push(['setSiteId', '9']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
    })();
    </script>
    <noscript><p><img src="http://piwik.spflow.com/piwik.php?idsite=9" style="border:0;" alt=""></p></noscript>
    <!-- End Piwik Code -->

</body>
