
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>SharePoint client side development with Live Reload</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="/assets/images/favicon.ico?v=82d17a0b14">

    <link rel="stylesheet" type="text/css" href="/assets/css/arvo-bundle.css?v=82d17a0b14">
    <link rel="stylesheet" type="text/css" href="/assets/css/prism.css?v=82d17a0b14">
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css?v=82d17a0b14">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400">

    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="ARVO Systems Blog">
    <meta property="og:type" content="article">
    <meta property="og:title" content="SharePoint client side development with Live Reload">
    <meta property="og:description" content="We're getting used to modern SharePoint (client side) development day by day. It transforms into some sort of a hybrid of Visual Studio Code'ing, Gulp tasks, and Chrome Dev Tools debugging and tweaks. More and more features from the funky front-end development are here at our disposal. Yet, there was">
    <meta property="og:url" content="/2016/11/05/sharepoint-client-side-development-with-live-reload/">
    <meta property="og:image" content="/content/images/2016/11/SharePointLiveReload.png">
    <meta property="article:published_time" content="2016-11-04T23:44:19.000Z">
    <meta property="article:modified_time" content="2016-11-05T00:07:29.000Z">
    <meta property="article:tag" content="SharePoint">
    <meta property="article:tag" content="Node.js">
    <meta property="article:tag" content="Gulp">
    <meta property="article:tag" content="Toolchain">
    <meta property="article:tag" content="Live Reload">
    
    <meta property="article:author" content="https://www.facebook.com/andrew.koltyakov">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SharePoint client side development with Live Reload">
    <meta name="twitter:description" content="We're getting used to modern SharePoint (client side) development day by day. It transforms into some sort of a hybrid of Visual Studio Code'ing, Gulp tasks, and Chrome Dev Tools debugging and tweaks. More and more features from the funky front-end development are here at our disposal. Yet, there was">
    <meta name="twitter:url" content="/2016/11/05/sharepoint-client-side-development-with-live-reload/">
    <meta name="twitter:image" content="/content/images/2016/11/SharePointLiveReload.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Andrew Koltyakov">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="SharePoint, Node.js, Gulp, Toolchain, Live Reload">
    <meta name="twitter:creator" content="@AndrewKoltyakov">
    <meta property="og:image:width" content="1338">
    <meta property="og:image:height" content="585">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "ARVO Systems Blog",
        "logo": {
            "@type": "ImageObject",
            "url": "/content/images/2016/09/arvo_logo_105px.png",
            "width": 105,
            "height": 42
        }
    },
    "author": {
        "@type": "Person",
        "name": "Andrew Koltyakov",
        "image": {
            "@type": "ImageObject",
            "url": "/content/images/2016/09/andrew.koltyakov.jpg",
            "width": 460,
            "height": 460
        },
        "url": "/author/andrew/",
        "sameAs": [
            "http://koltyakov.ru",
            "https://www.facebook.com/andrew.koltyakov",
            "https://twitter.com/AndrewKoltyakov"
        ],
        "description": "SharePoint Front-End Developer"
    },
    "headline": "SharePoint client side development with Live Reload",
    "url": "/2016/11/05/sharepoint-client-side-development-with-live-reload/",
    "datePublished": "2016-11-04T23:44:19.000Z",
    "dateModified": "2016-11-05T00:07:29.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "/content/images/2016/11/SharePointLiveReload.png",
        "width": 1338,
        "height": 585
    },
    "keywords": "SharePoint, Node.js, Gulp, Toolchain, Live Reload",
    "description": "We&#x27;re getting used to modern SharePoint (client side) development day by day. It transforms into some sort of a hybrid of Visual Studio Code&#x27;ing, Gulp tasks, and Chrome Dev Tools debugging and tweaks. More and more features from the funky front-end development are here at our disposal. Yet, there was",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://external.arvosys.com:2368"
    }
}
    </script>

    <meta name="generator" content="Ghost 0.10">
    <link rel="alternate" type="application/rss+xml" title="ARVO Systems Blog" href="../../../../rss/index.html">
</head>
<body class="post-template tag-sharepoint tag-node-js tag-gulp tag-toolchain tag-live-reload nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="index.html#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-blog-home" role="presentation"><a href="../../../../">Blog Home</a></li>
            <li class="nav-search" role="presentation"><a href="http://www.arvosys.com/search/">Search</a></li>
            <li class="nav-arvo-systems" role="presentation"><a href="http://www.arvosys.com/">ARVO Systems</a></li>
            <li class="nav--services" role="presentation"><a href="http://www.arvosys.com/services/">... Services</a></li>
            <li class="nav--platforms" role="presentation"><a href="http://www.arvosys.com/platforms/">... Platforms</a></li>
            <li class="nav--contacts" role="presentation"><a href="http://www.arvosys.com/about/contacts/">... Contacts</a></li>
    </ul>
        <a class="subscribe-button icon-feed" href="../../../../rss/index.rss">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">
        <div id="content-wrapper" class="page-content">

            


<header class="main-header post-head " style="background-image: url(../../../../content/images/2016/11/SharePointLiveReload.png)">
    <nav class="main-nav overlay clearfix">
        <a class="blog-logo" href="../../../../"><img src="../../../../content/images/2016/09/arvo_logo_105px.png" alt="ARVO Systems Blog"></a>
            <a class="menu-button icon-menu" href="index.html#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-sharepoint tag-node-js tag-gulp tag-toolchain tag-live-reload">

        <header class="post-header">
            <h1 class="post-title">SharePoint client side development with Live Reload</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2016-11-05">05 November 2016</time>  on <a href="../../../../tag/sharepoint/">SharePoint</a>, <a href="../../../../tag/node-js/">Node.js</a>, <a href="../../../../tag/gulp/">Gulp</a>, <a href="../../../../tag/toolchain/">Toolchain</a>, <a href="../../../../tag/live-reload/">Live Reload</a>
            </section>
        </header>

        <section class="post-content">
            <p>We're getting used to modern SharePoint (client side) development day by day. It transforms into some sort of a hybrid of Visual Studio Code'ing, Gulp tasks, and Chrome Dev Tools debugging and tweaks.</p>

<p>More and more features from the funky front-end development are here at our disposal. Yet, there was one which has been missed and desired by some engineers. You might have heard about BrowserSync, have you? It is a module which can be injected into the page(s) and watches for changes for instantaneous page reload or scripts reload. A developer saves a file in the editor and sees the result applied right away.</p>

<p>As we know, SharePoint has its nuances, which prevents BrowserSync from efficient working. Luckily there is an alternative now.</p>

<p>Recently I've wrapped up the technique we have been using in our team for last months into the NPM module - <a href="https://github.com/koltyakov/sp-live-reload">sp-live-reload</a>.</p>

<p>With <code>sp-live-reload</code> it's possible to save a local client side file, such as javascript, css, html (source for content editor web part) with immediate change in open browsers tabs without a necessity for manual page refresh:</p>

<p><img src="http://koltyakov.ru/images/LiveReloadSimpleDemo.gif" alt="SP Live Reload"></p>

<p>To make it work a developer can install the module with use of NPM command:</p>

<pre><code class="language-bash">npm install sp-live-reload --save-dev  
</code></pre>

<p>And then use the live reload in Gulp tasks as shown in examples on the project page.</p>

<p>We use it in the combination with SPSave, the module which makes files upload and publishing to SharePoint transparent.</p>

<p>The most controversial moment is how to deliver a live reload client script to SharePoint. Some possible issues are connected with that. As the environment can be shared between different persons.</p>

<p>There are following assumptions taken in mind:</p>

<ul>
<li>Live reload is actual in a development environment (less on a test, and almost never on the production)</li>
<li>There are limited developers on a specific development environment to conflict with each other</li>
<li>There is a variety of different browsers which should be supported by the reloading module</li>
</ul>

<p>With this being said, let me describe the approach:</p>

<ul>
<li>There are two options for delivering live reload client script to SharePoint:
<ul><li>Manual, when watch task is running it provides a URL to the script</li>
<li>Automated, a special gulp task exists for provisioning user custom action with script source </li></ul></li>
<li>Live reload script references for a localhost running server to receive information about updates, a developer who aren't running live reload task and doing something in the console just see one 404 error for a page load (this bothers me a bit, but it's possible to live with that)</li>
<li>Custom action can be easily retracted with another gulp task after the development session is finished to avoid any hassles</li>
<li>When two or more developers are "live watching" on the same site collection only one custom action is created, so all developers should share the same settings for the protocol and port, use default if possible</li>
</ul>

<p>A few words about the architectural implementation. Client and watch server use <a href="http://socket.io/">Socket.io</a> as a transport layer. All the browsers which are supported with Socket.io and SharePoint are automatically supported for live reload. <br>
The live reload server is running inside some watching task (gulp or other), on change and deliver events the server emits the message with the relative path for the resource in SharePoint which has been updated. <br>
The live reload client receives the messages from the server and checks if any resource is on the page. The client takes in mind SharePoint related features, like CEWP's source content. Also, there will be a support for a masterpage update and page layout update detection. As well as a community voice, as the module is extendable and open sourced.</p>

<p>Live reload works with On-Premises SharePoint installations (2016 and 2013) and SharePoint Online. Yet with SharePoint Online or any running over HTTPS some additional afford is needed to generate SSL certificate and add import it to trusted. But it worth it!</p>

<p><code>sp-live-reload</code> also is integrated into <a href="https://github.com/koltyakov/generator-sppp">generator-sppp</a> so you can use Yeoman generator to check it in action.</p>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="../../../../author/andrew/" style="background-image: url(../../../../content/images/2016/09/andrew.koltyakov.jpg)"><span class="hidden">Andrew Koltyakov's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="../../../../author/andrew/">Andrew Koltyakov</a></h4>

                    <p>SharePoint Front-End Developer</p>
                <div class="author-meta">
                    
                    <span class="author-link icon-link"><a href="http://koltyakov.ru">http://koltyakov.ru</a></span>
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=SharePoint%20client%20side%20development%20with%20Live%20Reload&amp;url=/2016/11/05/sharepoint-client-side-development-with-live-reload/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=/2016/11/05/sharepoint-client-side-development-with-live-reload/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=/2016/11/05/sharepoint-client-side-development-with-live-reload/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>


        </footer>

        <!-- Comments -->
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = "arvo-systems-blog-com";
            (function() {
                var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
                dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
                (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
            })();
        </script>
        <!-- Comments -->

    </article>

</main>

<aside class="read-next">
    <a class="read-next-story prev " style="background-image: url(../../../../content/images/2016/09/PnP-JS-Core_banner-2.png)" href="../../../09/09/sharepoint-pnp-javascript-core-components-deserve-more-attention/">
        <section class="post">
            <h2>SharePoint PnP JavaScript Core Components – deserve more attention</h2>
            <p>I've been eschewed PnP-JS-Core for a long time and preferred to use JSOM or plain REST calls with the…</p>
        </section>
    </a>
</aside>



        </div>
    </div>

    <div id="footer" class="bg-dark fg-white">
        <div class="container">
            <div class="brands">
                <div class="padding10 footer-element">
                <img class="sh" src="/assets/images/o365_nm_ft_i.png?v=82d17a0b14" style="display: none;">
                <img class="fl" src="/assets/images/o365_nm_ft.png?v=82d17a0b14">
                </div>
                <div class="padding10 footer-element">
                <img class="sh" src="/assets/images/sp_nm_ft_i.png?v=82d17a0b14" style="display: none;">
                <img class="fl" src="/assets/images/sp_nm_ft.png?v=82d17a0b14">
                </div>
                <div class="padding10 footer-element">
                <img class="sh" src="/assets/images/msp_nm_ft_i.png?v=82d17a0b14" style="display: none;">
                <img class="fl" src="/assets/images/msp_nm_ft.png?v=82d17a0b14">
                </div>		
            </div>
            <div class="copyright">
                <div class="padding10 footer-element">
                <img src="/assets/images/arvo_nm_ft.png?v=82d17a0b14">
                </div>    
                <div class="padding10 footer-element copy-text">© 2016<br>
                <small>All rights reserved</small>
                </div> 
            </div>
        </div>
    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js?v=82d17a0b14"></script>
    <script type="text/javascript" src="/assets/js/index.js?v=82d17a0b14"></script>
    <script type="text/javascript" src="/assets/js/prism.js?v=82d17a0b14"></script>

    <!-- Piwik -->
    <script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(["setDomains", ["*.arvosys.com","*.blog.arvosys.com","*.www.arvosys.com","*.blog.arvosys.com"]]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
        var u="//piwik.spflow.com/";
        _paq.push(['setTrackerUrl', u+'piwik.php']);
        _paq.push(['setSiteId', '9']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
    })();
    </script>
    <noscript><p><img src="http://piwik.spflow.com/piwik.php?idsite=9" style="border:0;" alt=""></p></noscript>
    <!-- End Piwik Code -->

</body>
